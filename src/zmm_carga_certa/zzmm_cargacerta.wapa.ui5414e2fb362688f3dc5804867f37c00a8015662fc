sap.ui.define([                                                                                                                                                                                                                                                
    "sap/ui/core/mvc/Controller",                                                                                                                                                                                                                              
    "sap/m/MessageBox",                                                                                                                                                                                                                                        
	"sap/m/MessageToast"                                                                                                                                                                                                                                          
],                                                                                                                                                                                                                                                             
    /**                                                                                                                                                                                                                                                        
     * @param {typeof sap.ui.core.mvc.Controller} Controller                                                                                                                                                                                                   
     */                                                                                                                                                                                                                                                        
    function (Controller, MessageBox, MsgToast) {                                                                                                                                                                                                              
        "use strict";                                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
        return Controller.extend("br.com.trescoracoes.pcargacerta.controller.View1", {                                                                                                                                                                         
            onInit: function () {                                                                                                                                                                                                                              
                var oServiceUrl = "/sap/opu/odata/sap/ZUI_O2_PLANLOG_EXECUTE";                                                                                                                                                                                 
                var oModel = new sap.ui.model.odata.v2.ODataModel(oServiceUrl, {                                                                                                                                                                               
                    useBatch: true                                                                                                                                                                                                                             
                });                                                                                                                                                                                                                                            
                this.getView().setModel(oModel);                                                                                                                                                                                                               
                this.localModel = new sap.ui.model.json.JSONModel();                                                                                                                                                                                           
                this.getView().setModel(this.localModel, "localModel");                                                                                                                                                                                        
            },                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            onExecutarPress: function() {                                                                                                                                                                                                                      
                debugger;                                                                                                                                                                                                                                      
                var tran = this.getView().byId("InputTran").getSelectedKey();                                                                                                                                                                                  
                var vari = this.getView().byId("InputVari").getValue();                                                                                                                                                                                        
                var oServiceUrl = "/sap/opu/odata/sap/ZUI_O2_PLANLOG_EXECUTE";&nbsp;                                                                                                                                                                           
                var oModel = new sap.ui.model.odata.v2.ODataModel(oServiceUrl, {                                                                                                                                                                               
                            useBatch: true                                                                                                                                                                                                                     
                        });                                                                                                                                                                                                                                    
                                                                                                                                                                                                                                                               
                        if (!tran) {                                                                                                                                                                                                                           
                            jQuery.sap.require("sap.m.MessageBox");                                                                                                                                                                                            
                            sap.m.MessageBox.show("Campo Transação Obrigatório!", {                                                                                                                                                                            
                                icon: sap.m.MessageBox.Icon.ERROR, // default                                                                                                                                                                                  
                                title: "Informação", // default                                                                                                                                                                                                
                                actions: sap.m.MessageBox.Action.OK, // default                                                                                                                                                                                
                                onClose: null, // default                                                                                                                                                                                                      
                                styleClass: "", // default                                                                                                                                                                                                     
                                initialFocus: null, // default                                                                                                                                                                                                 
                                textDirection: sap.ui.core.TextDirection.Inherit, // default                                                                                                                                                                   
                                verticalScrolling: true, // default                                                                                                                                                                                            
                                horizontalScrolling: true // default                                                                                                                                                                                           
                            });                                                                                                                                                                                                                                
                            return;                                                                                                                                                                                                                            
                        }                                                                                                                                                                                                                                      
                                                                                                                                                                                                                                                               
                        if (!vari) {                                                                                                                                                                                                                           
                            jQuery.sap.require("sap.m.MessageBox");                                                                                                                                                                                            
                            sap.m.MessageBox.show("Campo Variante Obrigatório!", {                                                                                                                                                                             
                                icon: sap.m.MessageBox.Icon.ERROR, // default                                                                                                                                                                                  
                                title: "Informação", // default                                                                                                                                                                                                
                                actions: sap.m.MessageBox.Action.OK, // default                                                                                                                                                                                
                                onClose: null, // default                                                                                                                                                                                                      
                                styleClass: "", // default                                                                                                                                                                                                     
                                initialFocus: null, // default                                                                                                                                                                                                 
                                textDirection: sap.ui.core.TextDirection.Inherit, // default                                                                                                                                                                   
                                verticalScrolling: true, // default                                                                                                                                                                                            
                                horizontalScrolling: true // default                                                                                                                                                                                           
                            });                                                                                                                                                                                                                                
                            return;                                                                                                                                                                                                                            
                        }                                                                                                                                                                                                                                      
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
                var createPath = "/ZC_MM_PLANLOG_EXECUTE_GET"                                                                                                                                                                                                  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
                var oEntry = {							                                                                                                                                                                                                                          
                            ztran: tran,                                                                                                                                                                                                                       
                            zvari: vari                                                                                                                                                                                                                        
                        };                                                                                                                                                                                                                                     
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
            var oSettings = {                                                                                                                                                                                                                                  
                            success: function(data, response) {                                                                                                                                                                                                
                                debugger;                                                                                                                                                                                                                      
                                jQuery.sap.require("sap.m.MessageBox");                                                                                                                                                                                        
                                sap.m.MessageBox.show("Programa executado com sucesso! ", {                                                                                                                                                                    
                                    icon: sap.m.MessageBox.Icon.SUCCESS, // default                                                                                                                                                                            
                                    title: "Informação", // default                                                                                                                                                                                            
                                    actions: sap.m.MessageBox.Action.OK, // default                                                                                                                                                                            
                                    onClose: function(oAction) {},                                                                                                                                                                                             
                                    styleClass: "", // default                                                                                                                                                                                                 
                                    initialFocus: null, // default                                                                                                                                                                                             
                                    textDirection: sap.ui.core.TextDirection.Inherit, // default                                                                                                                                                               
                                    verticalScrolling: true, // default                                                                                                                                                                                        
                                    horizontalScrolling: true // default                                                                                                                                                                                       
                                });                                                                                                                                                                                                                            
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
                            },                                                                                                                                                                                                                                 
                            error: function(oError) {                                                                                                                                                                                                          
                               debugger;                                                                                                                                                                                                                       
                                var msg = JSON.parse(oError.responseText);                                                                                                                                                                                     
                               var msgerror = msg.error.innererror.errordetails[0].message                                                                                                                                                                     
                        //    var msgerror = "Erro ao executar Programa/Transação"                                                                                                                                                                             
					MessageBox.show("" + msgerror, {                                                                                                                                                                                                                          
						icon: sap.m.MessageBox.Icon.ERROR, // default                                                                                                                                                                                                            
						title: "Informação", // default                                                                                                                                                                                                                          
						actions: sap.m.MessageBox.Action.OK, // default                                                                                                                                                                                                          
						styleClass: "", // default                                                                                                                                                                                                                               
						initialFocus: null, // default                                                                                                                                                                                                                           
						textDirection: sap.ui.core.TextDirection.Inherit, // default                                                                                                                                                                                             
						verticalScrolling: true, // default                                                                                                                                                                                                                      
						horizontalScrolling: true // default                                                                                                                                                                                                                     
					});                                                                                                                                                                                                                                                       
                            }                                                                                                                                                                                                                                  
                        };                                                                                                                                                                                                                                     
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
                oModel.create(createPath, oEntry, oSettings);&nbsp;                                                                                                                                                                                            
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
            },                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            onSelectionChange: function(oEvent) {                                                                                                                                                                                                              
                debugger;                                                                                                                                                                                                                                      
                this.getView().byId("InputVari").setEnabled(true);                                                                                                                                                                                             
                var variante = this.getView().byId("InputVari");                                                                                                                                                                                               
                var sValue = this.getView().byId("InputTran").getSelectedKey();                                                                                                                                                                                
                var oFilter1 = new sap.ui.model.Filter('report', sap.ui.model.FilterOperator.EQ, sValue);                                                                                                                                                      
                var filters = [oFilter1];                                                                                                                                                                                                                      
                variante.getBinding("items").filter(filters, sap.ui.model.FilterType.Application);                                                                                                                                                             
                variante.setSelectedKey();                                                                                                                                                                                                                     
            },                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            onLoadVariant: function(oControlEvent) {                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
        var sValue = this.getView().byId("InputTran").getSelectedKey();                                                                                                                                                                                        
        var oFilter1 = new sap.ui.model.Filter('report', sap.ui.model.FilterOperator.EQ, sValue);                                                                                                                                                              
        var filters = [oFilter1];                                                                                                                                                                                                                              
        oControlEvent.getSource().getBinding("items").filter(filters, sap.ui.model.FilterType.Application);                                                                                                                                                    
            }                                                                                                                                                                                                                                                  
        });                                                                                                                                                                                                                                                    
    });                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               