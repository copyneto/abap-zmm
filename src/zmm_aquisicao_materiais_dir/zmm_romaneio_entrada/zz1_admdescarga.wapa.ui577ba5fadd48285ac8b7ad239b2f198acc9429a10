sap.ui.define(["sap/m/PDFViewer"],                                                                                                                                                                                                                             
    function (PDFViewer) {                                                                                                                                                                                                                                     
        "use strict";                                                                                                                                                                                                                                          
        return {                                                                                                                                                                                                                                               
            onActionImprimir: function (oEvent) {                                                                                                                                                                                                              
                /* ===================================================================&nbsp;                                                                                                                                                                   
                                Recupa referência à tabela do relatório                                                                                                                                                                                        
                                =================================================================== */                                                                                                                                                         
                var oItems = this.templateBaseExtension.getExtensionAPI().getSelectedContexts();                                                                                                                                                               
                //var oItems = sap.ui.getCore().byId(this.oView.sId + '--responsiveTable').getItems();                                                                                                                                                         
                var oServiceUrl = "/sap/opu/odata/SAP/ZMM_IMPRIME_ROMANEIO_SRV/";                                                                                                                                                                              
                var oModel = new sap.ui.model.odata.ODataModel(oServiceUrl, false);                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                /* ===================================================================&nbsp;                                                                                                                                                                   
                Recupera PDFs das linhas selecionadas                                                                                                                                                                                                          
                =================================================================== */                                                                                                                                                                         
                for (let i = 0; i < oItems.length; i++) {                                                                                                                                                                                                      
                    //sap.ui.core.util.File.save(oData.Value, 'device', 'pdf', 'application/pdf', 'utf-8', false);                                                                                                                                             
                    var oObject = oItems[i].getObject();                                                                                                                                                                                                       
                    var waitFunction = async function () {                                                                                                                                                                                                     
                        // first code block ...                                                                                                                                                                                                                
                        await delay(5000);                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
                        // some more code, executed 5 seconds after the first code block finishes                                                                                                                                                              
                    };                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
                    var oSource = oServiceUrl + "imprimirSet(Romaneio='" + oObject.Romaneio + "')/$value";                                                                                                                                                     
                    var oPDFViewer = new PDFViewer();                                                                                                                                                                                                          
                    this.getView().addDependent(oPDFViewer);                                                                                                                                                                                                   
                    oPDFViewer.setSource(oSource);                                                                                                                                                                                                             
                    oPDFViewer.downloadPDF();                                                                                                                                                                                                                  
                }                                                                                                                                                                                                                                              
                this.templateBaseExtension.getExtensionAPI().rebindTable();                                                                                                                                                                                    
                this.templateBaseExtension.getExtensionAPI().refreshTable();                                                                                                                                                                                   
            }                                                                                                                                                                                                                                                  
        };                                                                                                                                                                                                                                                     
    });                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               