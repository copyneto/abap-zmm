sap.ui.define(["sap/ui/export/Spreadsheet","sap/ui/export/library","sap/ui/model/json/JSONModel","sap/ui/core/util/Export","sap/ui/core/util/ExportTypeCSV"],function(e,a,t,r,s,o){"use strict";var i=a.EdmType;return sap.ui.controller("br.com.trescoracoes.+
zmmnbs.ext.controller.ListReportExt",{createColumnConfigServ:function(){var e=[];e.push({label:"Material",property:"Matnr",type:i.String});e.push({label:"NBS",property:"Nbs",type:i.String});return e},DownloadExcel:function(a){var r,s,o,i,n;var l="/sap/op+
u/odata/sap/ZUI_O2_MM_NBS";var p=new sap.ui.model.odata.ODataModel(l,false);if(!this._oTable){this._oTable=this.byId("br.com.trescoracoes.zmmnbs::sap.suite.ui.generic.template.ListReport.view.ListReport::ZC_MM_NBS--responsiveTable")}var u=this._oTable;va+
r d=u.getBinding("items");r=this.createColumnConfigServ();p.read("/ZC_MM_NBS",{filters:n,success:function(a){var n=a.results;var l=new t(n);sap.ui.getCore().setModel(l,"Download");i=sap.ui.getCore().getModel("Download").getProperty("/");s={workbook:{colu+
mns:r},dataSource:r,fileName:"DownloadLayout.xlsx"};o=new e(s);o.build().finally(function(){o.destroy()})}.bind(this),error:function(e){alert("Falha no download")}.bind(this)})},UploadExcel:function(e){var a=new sap.m.Dialog({contentWidth:"300px",resizab+
le:true,type:"Message"});a.setTitle("Carregar arquivo Excel");var t="/sap/opu/odata/SAP/ZMM_ENTR_SERV_NBS_SRV/";var r=new sap.ui.model.odata.ODataModel(t,false);var s=t+"UploadSet";var o=new sap.ui.unified.FileUploader({width:"100%",fileType:["xlsx","xls+
","csv"],typeMissmatch:this.handleTypeMissmatch,uploadComplete:function(e){var t=this.oView.sId+"--responsiveTable";var r=this.byId(t);r.getModel().refresh(true);a.close();a.destroy();if(e.mParameters.status=="200"||e.mParameters.status=="201"||e.mParame+
ters.status=="204"){sap.m.MessageToast.show("Carga realizada com sucesso.")}else{sap.m.MessageToast.show("Erro ao importar, verificar os materiais do arquivo")}}.bind(this)});o.setName("Simple Uploader");o.setUploadUrl(s);o.setSendXHR(true);o.setUseMulti+
part(false);o.setUploadOnChange(false);var i=new sap.ui.unified.FileUploaderParameter({name:"x-csrf-token",value:r.getSecurityToken()});o.insertHeaderParameter(i);var n=new sap.m.Button({text:"Upload",type:"Accept",press:function(){var e=o.getFocusDomRef+
();var a=e.files[0];if(o.getValue()===""){sap.m.MessageToast.show("Favor selecionar um arquivo");return}var t=new sap.ui.unified.FileUploaderParameter({name:"Content-Type",value:a.type});o.insertHeaderParameter(t);o.insertHeaderParameter(new sap.ui.unifi+
ed.FileUploaderParameter({name:"SLUG",value:o.getValue()}));o.upload()}.bind(this)});var l=new sap.m.Button({text:"Cancelar",type:"Reject",press:function(){a.close();a.destroy();this.getView().removeAllDependents()}.bind(this)});a.addContent(o);a.setBegi+
nButton(l);a.setEndButton(n);a.open()},handleTypeMissmatch:function(e){var a=e.getSource().getFileType();jQuery.each(a,function(e,t){a[e]="*."+t});var t=a.join(", ");sap.m.MessageToast.show("Tipo de arquivo *."+e.getParameter("fileType")+" nao ? suportad+
o. Escolha um dos tipos a seguir: "+t)}})});                                                                                                                                                                                                                   