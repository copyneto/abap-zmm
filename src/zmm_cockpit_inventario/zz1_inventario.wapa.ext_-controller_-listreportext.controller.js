sap.ui.define(["sap/ui/export/Spreadsheet","sap/ui/export/library"],function(e,t){"use strict";return sap.ui.controller("br.com.trescoracoes.cockpitinventario.ext.controller.ListReportExt",{onActionDownloadLayout:function(a){var r=[];r.push({label:"Plant+
a",property:"Planta",type:t.EdmType.String});r.push({label:"Data da Contagem",property:"DataDaContagem",type:t.EdmType.String});r.push({label:"Deposito",property:"Deposito",type:t.EdmType.String});r.push({label:"Material",property:"Material",type:t.EdmTy+
pe.String});r.push({label:"Lote",property:"Lote",type:t.EdmType.String});r.push({label:"Contagem",property:"Contagem",type:t.EdmType.String});r.push({label:"UM",property:"UM",type:t.EdmType.String});var n={workbook:{columns:r},dataSource:[""],count:1,fil+
eName:"Inventario.xlsx"};var o=new e(n);o.build().finally(function(){o.destroy()})},onActionUploadFile:function(e){var t=this;var a=new sap.m.Dialog({contentWidth:"300px",resizable:true,type:"Message"});a.setTitle("Carregar arquivo Excel");var r="/sap/op+
u/odata/SAP/ZMM_INVENTARIO_SRV/";var n=new sap.ui.model.odata.ODataModel(r,false);var o=r+"uploadSet";var s=new sap.ui.unified.FileUploader({width:"100%",fileType:["xlsx","xls"],typeMissmatch:this.handleTypeMissmatch,uploadComplete:function(e){var r=this+
.oView.sId+"--responsiveTable";var n=this.byId(r);t.templateBaseExtension.getExtensionAPI().refreshTable();a.close();a.destroy();if(e.mParameters.status=="200"||e.mParameters.status=="201"){sap.m.MessageToast.show("Carga realizada com sucesso.")}else{if(+
e.mParameters.response){if(e.mParameters.responseRaw.search("<message>")){var o=e.mParameters.responseRaw.split("<message>")[1].split("</message>")[0];alert(o)}else{alert("Return Code: "+e.mParameters.response,"Response","Response")}}}}.bind(this)});s.se+
tName("Simple Uploader");s.setUploadUrl(o);s.setSendXHR(true);s.setUseMultipart(false);s.setUploadOnChange(false);var i=new sap.ui.unified.FileUploaderParameter({name:"x-csrf-token",value:n.getSecurityToken()});s.insertHeaderParameter(i);var l=new sap.m.+
Button({text:"Upload",type:"Accept",press:function(){var e=s.getFocusDomRef();var t=e.files[0];if(s.getValue()===""){sap.m.MessageToast.show("Favor selecionar um arquivo");return}var a=new sap.ui.unified.FileUploaderParameter({name:"Content-Type",value:t+
.type});s.insertHeaderParameter(a);s.insertHeaderParameter(new sap.ui.unified.FileUploaderParameter({name:"SLUG",value:s.getValue()}));s.upload()}.bind(this)});var p=new sap.m.Button({text:"Cancelar",type:"Reject",press:function(){a.close();a.destroy();t+
his.getView().removeAllDependents()}.bind(this)});a.addContent(s);a.setBeginButton(p);a.setEndButton(l);a.open()},handleTypeMissmatch:function(e){var t=e.getSource().getFileType();jQuery.each(t,function(e,a){t[e]="*."+a});var a=t.join(", ");sap.m.Message+
Toast.show("Tipo de arquivo *."+e.getParameter("fileType")+" não é suportado. Escolha um dos tipos a seguir: "+a)},onActionExportExcel:function(e){},showLogs:function(e){var t=this.extensionAPI.getSelectedContexts();var a=t[0].getObject();var r=a.Externa+
lRef;sap.ushell.Container.getServiceAsync("CrossApplicationNavigation").then(function(e){var t=e.hrefForExternal({target:{semanticObject:"ApplicationLog",action:"showList"},params:{LogObjectId:"ZMM_INVENT_FIS",LogExternalId:r,DateFrom:a.DataLanc.toLocale+
DateString().split("/").reverse().join("-")}});var n=window.location.href.split("#")[0]+t;sap.m.URLHelper.redirect(n,true)})},onActionEncerrarInventario:function(e){var t=this.extensionAPI.getSelectedContexts();var a=[];var r=[];for(let e=0;e<t.length;e++
+){a[e]=t[e].getObject().FiscalYear;r[e]=t[e].getObject().PhysicalInventoryDocument}sap.ushell.Container.getService("CrossApplicationNavigation").isNavigationSupported([{target:{shellHash:"PhysicalInventoryDocument-changePhysicalInventoryDocumentInWebGUI+
?FiscalYear="+a+",PhysicalInventoryDocument="+r}}]).done(function(e){e.map(function(e,t){if(e.supported===true){var n=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation").hrefForExternal({target:{semanticObject:+
"PhysicalInventoryDocument",action:"changePhysicalInventoryDocumentInWebGUI"},params:{FiscalYear:a,PhysicalInventoryDocument:r}});sap.m.URLHelper.redirect(n,false)}else{alert("Usuário sem permissão para acessar o link")}})}).fail(function(){alert("Falha +
ao acessar o link")})},onActionEstornaDocCont:function(e){var t=this.extensionAPI.getSelectedContexts();var a=[];var r=[];var n=[];for(let e=0;e<t.length;e++){a[e]=t[e].getObject().FiscalYear;r[e]=t[e].getObject().DocComp;n[e]=t[e].getObject().Empresa}sa+
p.ushell.Container.getService("CrossApplicationNavigation").isNavigationSupported([{target:{shellHash:"AccountingDocument-reverseDocument?FiscalYear="+a+",AccountingDocument="+r+",CompanyCode="+n}}]).done(function(e){e.map(function(e,t){if(e.supported===+
true){var o=sap.ushell&&sap.ushell.Container&&sap.ushell.Container.getService("CrossApplicationNavigation").hrefForExternal({target:{semanticObject:"AccountingDocument",action:"reverseDocument"},params:{FiscalYear:a,AccountingDocument:r,CompanyCode:n}});+
sap.m.URLHelper.redirect(o,false)}else{alert("Usuário sem permissão para acessar o link")}})}).fail(function(){alert("Falha ao acessar o link")})}})});                                                                                                        