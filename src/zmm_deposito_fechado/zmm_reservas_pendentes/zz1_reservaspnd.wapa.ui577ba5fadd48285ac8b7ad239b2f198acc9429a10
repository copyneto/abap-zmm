sap.ui.define([],                                                                                                                                                                                                                                              
    function () {                                                                                                                                                                                                                                              
        "use strict";                                                                                                                                                                                                                                          
        return {                                                                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
            onChangeAvailableCheckBoxAction: function (oEvent) {                                                                                                                                                                                               
                                                                                                                                                                                                                                                               
                var that = this;                                                                                                                                                                                                                               
                var oCheckbox = oEvent.getSource();                                                                                                                                                                                                            
                var oBindingContext = oEvent.getSource().getBindingContext();                                                                                                                                                                                  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                               
                /* ===================================================================&nbsp;                                                                                                                                                                   
                Verifica se Checkbox foi marcado e atualiza campo montante                                                                                                                                                                                     
                =================================================================== */                                                                                                                                                                         
                if( oCheckbox.getSelected()) {                                                                                                                                                                                                                 
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                       
                    /* Recupera a tabela e o campo do relatório */                                                                                                                                                                                             
                    var oData = this.getView().getModel().getProperty(oEvent.getSource().getBindingContext().sPath);                                                                                                                                           
                    oData.UsedStock_conve = oData.AvailableStock_Conve;                                                                                                                                                                                        
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                       
                    /* Atualiza diretamente o relatório */                                                                                                                                                                                                     
                    var vUsedStockConvePath = oEvent.getSource().getBindingContext().sPath + '/UsedStock_conve';                                                                                                                                               
                    this.getView().getModel().setProperty( vUsedStockConvePath, oData.UsedStock_conve );                                                                                                                                                       
                }                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
                /* ===================================================================&nbsp;                                                                                                                                                                   
                Chama Action no Behavior da CDS&nbsp;                                                                                                                                                                                                          
                =================================================================== */                                                                                                                                                                         
                var fnFunction = function () {                                                                                                                                                                                                                 
                    return new Promise(function (fnResolve, fnReject) {                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
                        that.extensionAPI.invokeActions(                                                                                                                                                                                                       
                            "/fragmentCheckBox",                                                                                                                                                                                                               
                            oBindingContext,                                                                                                                                                                                                                   
                            {                                                                                                                                                                                                                                  
                                "UseAvailableCheckBox": oBindingContext.getObject().UseAvailableCheckBox ? true : false                                                                                                                                        
                            },                                                                                                                                                                                                                                 
                        ).then(function (data) {                                                                                                                                                                                                               
                            fnResolve();                                                                                                                                                                                                                       
                            that.templateBaseExtension.getExtensionAPI().refreshTable();                                                                                                                                                                       
                        });                                                                                                                                                                                                                                    
                    });                                                                                                                                                                                                                                        
                }                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
                var mParameters = {                                                                                                                                                                                                                            
                    busy: {                                                                                                                                                                                                                                    
                        set: true,                                                                                                                                                                                                                             
                        check: false                                                                                                                                                                                                                           
                    },                                                                                                                                                                                                                                         
                    dataloss: {                                                                                                                                                                                                                                
                        popup: false,                                                                                                                                                                                                                          
                        navigation: false                                                                                                                                                                                                                      
                    }                                                                                                                                                                                                                                          
                };                                                                                                                                                                                                                                             
                this.extensionAPI.securedExecution(fnFunction, mParameters);                                                                                                                                                                                   
            },                                                                                                                                                                                                                                                 
                                                                                                                                                                                                                                                               
            onChangeUsedStockAction: function (oEvent) {                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
                var that = this;                                                                                                                                                                                                                               
                var oInput = oEvent.getSource();                                                                                                                                                                                                               
                var oBindingContext = oEvent.getSource().getBindingContext();                                                                                                                                                                                  
                                                                                                                                                                                                                                                               
                /* ===================================================================&nbsp;                                                                                                                                                                   
                Seta valor máximo do campo Input                                                                                                                                                                                                               
                =================================================================== */                                                                                                                                                                         
                //if (!oInput.getMax()) {                                                                                                                                                                                                                      
                //    oInput.setMax(parseFloat(oBindingContext.getObject().AvailableStock_Conve));                                                                                                                                                             
                //}                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                /* ===================================================================&nbsp;                                                                                                                                                                   
                Se valor for maior que o máximo, apenas voltar. Como setamos acima o&nbsp;                                                                                                                                                                     
                novo valor do máximo, o SetupInput vai fazer a tratativa do erro                                                                                                                                                                               
                =================================================================== */                                                                                                                                                                         
                //if (oInput.getValue() > oInput.getMax()) {                                                                                                                                                                                                   
                //    return;                                                                                                                                                                                                                                  
                //}                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                /* ===================================================================&nbsp;                                                                                                                                                                   
                Limpa status de validações anteriores&nbsp;                                                                                                                                                                                                    
                =================================================================== */                                                                                                                                                                         
                //oInput.setValueState( sap.ui.core.ValueState.None );                                                                                                                                                                                         
                //oInput.setValueStateText( '' );                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
                /* ===================================================================&nbsp;                                                                                                                                                                   
                O Exemplo acima fica com algum lixo quando setamos o valor máximo.                                                                                                                                                                             
                A solução abaixo é mais simples, montamos a mensagem de erro                                                                                                                                                                                   
                =================================================================== */                                                                                                                                                                         
                if (oInput.getValue() > oBindingContext.getObject().AvailableStock_Conve ) {                                                                                                                                                                   
                    oInput.setValueState( sap.ui.core.ValueState.Error );                                                                                                                                                                                      
                    oInput.setValueStateText( 'Insira um número menor ou igual a ' + oBindingContext.getObject().AvailableStock_Conve );                                                                                                                       
                    return;                                                                                                                                                                                                                                    
                }                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
                var vNewUsedStock = parseFloat( oInput.getValue() );                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                /* ===================================================================&nbsp;                                                                                                                                                                   
                Chama Action no Behavior da CDS&nbsp;                                                                                                                                                                                                          
                =================================================================== */                                                                                                                                                                         
                var fnFunction = function () {                                                                                                                                                                                                                 
                    return new Promise(function (fnResolve, fnReject) {                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
                        that.extensionAPI.invokeActions(                                                                                                                                                                                                       
                            "/fragmentUsedStock",                                                                                                                                                                                                              
                            oBindingContext,                                                                                                                                                                                                                   
                            {                                                                                                                                                                                                                                  
                                "NewUsedStock": vNewUsedStock                                                                                                                                                                                                  
                            },                                                                                                                                                                                                                                 
                        ).then(function (data) {                                                                                                                                                                                                               
                            fnResolve();                                                                                                                                                                                                                       
                            that.templateBaseExtension.getExtensionAPI().refreshTable();                                                                                                                                                                       
                            that.getView().getModel().refresh();                                                                                                                                                                                               
                        });                                                                                                                                                                                                                                    
                    });                                                                                                                                                                                                                                        
                }                                                                                                                                                                                                                                              
                                                                                                                                                                                                                                                               
                var mParameters = {                                                                                                                                                                                                                            
                    busy: {                                                                                                                                                                                                                                    
                        set: true,                                                                                                                                                                                                                             
                        check: false                                                                                                                                                                                                                           
                    },                                                                                                                                                                                                                                         
                    dataloss: {                                                                                                                                                                                                                                
                        popup: false,                                                                                                                                                                                                                          
                        navigation: false                                                                                                                                                                                                                      
                    }                                                                                                                                                                                                                                          
                };                                                                                                                                                                                                                                             
                this.extensionAPI.securedExecution(fnFunction, mParameters);                                                                                                                                                                                   
                                                                                                                                                                                                                                                               
            }                                                                                                                                                                                                                                                  
        };                                                                                                                                                                                                                                                     
    });                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               