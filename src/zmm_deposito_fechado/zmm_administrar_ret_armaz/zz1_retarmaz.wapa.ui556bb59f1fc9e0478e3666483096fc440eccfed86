sap.ui.define([],                                                                                                                                                                                                                                              
    function () {                                                                                                                                                                                                                                              
        "use strict";                                                                                                                                                                                                                                          
        return {                                                                                                                                                                                                                                               
            onActionCreateSeries: function (oEvent) {                                                                                                                                                                                                          
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                                                                                                                               
                var that = this                                                                                                                                                                                                                                
                var oBindingContext = oEvent.getSource().getBindingContext();&nbsp;                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                /* ===================================================================&nbsp;                                                                                                                                                                   
                Prepara conteúdo do pop-up                                                                                                                                                                                                                     
                =================================================================== */                                                                                                                                                                         
                var oContent = new sap.ui.layout.VerticalLayout({                                                                                                                                                                                              
                    width: '100%',                                                                                                                                                                                                                             
                    content: [                                                                                                                                                                                                                                 
                        new sap.m.MultiInput('inSeries', {                                                                                                                                                                                                     
                            showValueHelp: false,                                                                                                                                                                                                              
                        })                                                                                                                                                                                                                                     
                                                                                                                                                                                                                                                               
                    ]                                                                                                                                                                                                                                          
                })                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
                var oButtonBegin =  new sap.m.Button({                                                                                                                                                                                                         
                    type: sap.m.ButtonType.Emphasized,                                                                                                                                                                                                         
                    text: "Adicionar",                                                                                                                                                                                                                         
                    press: function () {                                                                                                                                                                                                                       
                                                                                                                                                                                                                                                               
                        // Get array of Tokens&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;                                                           
                        var aTokens = sap.ui.getCore().byId('inSeries').getTokens();                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                        // Get an array of the keys of the tokens and join them together with a ";" inbetween                                                                                                                                                  
                        var series = aTokens.map(function (oToken) {                                                                                                                                                                                           
                            return oToken.getKey();                                                                                                                                                                                                            
                        }).join(";");                                                                                                                                                                                                                          
                                                                                                                                                                                                                                                               
                        pressDialog.close();                                                                                                                                                                                                                   
                        var that = this                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               
                        var fnFunction = function () {                                                                                                                                                                                                         
                            return new Promise(function (fnResolve, fnReject) {                                                                                                                                                                                
                                                                                                                                                                                                                                                               
                                that.extensionAPI.invokeActions(                                                                                                                                                                                               
                                    "/adicionarSerie",                                                                                                                                                                                                         
                                    oBindingContext,                                                                                                                                                                                                           
                                    {                                                                                                                                                                                                                          
                                        "SerialNoList": series&nbsp;                                                                                                                                                                                           
                                    },                                                                                                                                                                                                                         
                                ).then(function (data) {                                                                                                                                                                                                       
                                    fnResolve();                                                                                                                                                                                                               
                                    that.oView.getController().extensionAPI.refresh();                                                                                                                                                                         
                                });                                                                                                                                                                                                                            
                            }.bind(this));                                                                                                                                                                                                                     
                        }.bind(this)                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                        var mParameters = {                                                                                                                                                                                                                    
                            dataloss: false                                                                                                                                                                                                                    
                        };                                                                                                                                                                                                                                     
                        this.extensionAPI.securedExecution(fnFunction, mParameters);                                                                                                                                                                           
                                                                                                                                                                                                                                                               
                    }.bind(this)                                                                                                                                                                                                                               
                });                                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                /* ===================================================================&nbsp;                                                                                                                                                                   
                Prepara pop-up                                                                                                                                                                                                                                 
                =================================================================== */                                                                                                                                                                         
                var pressDialog = new sap.m.Dialog({                                                                                                                                                                                                           
                    type: 'Message',                                                                                                                                                                                                                           
                    title: "Informar as séries",                                                                                                                                                                                                               
                    resizable: true,                                                                                                                                                                                                                           
                    draggable: true,                                                                                                                                                                                                                           
                    titleAlignment: sap.m.TitleAlignment.Center,                                                                                                                                                                                               
                    content: oContent,                                                                                                                                                                                                                         
                    beginButton: oButtonBegin,                                                                                                                                                                                                                 
                    endButton: new sap.m.Button({                                                                                                                                                                                                              
                        text: "Cancelar",                                                                                                                                                                                                                      
                        press: function () {                                                                                                                                                                                                                   
                            pressDialog.close();                                                                                                                                                                                                               
                        }                                                                                                                                                                                                                                      
                    }),                                                                                                                                                                                                                                        
                    afterClose: function () {                                                                                                                                                                                                                  
                        pressDialog.destroy();                                                                                                                                                                                                                 
                    },                                                                                                                                                                                                                                         
                                                                                                                                                                                                                                                               
                });                                                                                                                                                                                                                                            
                pressDialog.open();                                                                                                                                                                                                                            
                                                                                                                                                                                                                                                               
                var oMultiInput = sap.ui.getCore().byId("inSeries");                                                                                                                                                                                           
                var fnValidator = function (args) {                                                                                                                                                                                                            
                    var text = args.text;                                                                                                                                                                                                                      
                    return new sap.m.Token({ key: text, text: text });                                                                                                                                                                                         
                };                                                                                                                                                                                                                                             
                                                                                                                                                                                                                                                               
                oMultiInput.addValidator(fnValidator);                                                                                                                                                                                                         
            },                                                                                                                                                                                                                                                 
        onActionTeste: function(oEvent) {                                                                                                                                                                                                                      
            alert('onActionTeste');                                                                                                                                                                                                                            
        }                                                                                                                                                                                                                                                      
    };                                                                                                                                                                                                                                                         
    });                                                                                                                                                                                                                                                        
                                                                                                                                                                                                                                                               